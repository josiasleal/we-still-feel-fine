/*! We Still Feel Fine Client JS v0.0.1 | Copyright 2013 Lauren Sperber https://github.com/lauren/we-still-feel-fine/blob/master/LICENSE | we-still-feel-fine 2013-08-13 */
!function(){window.onload=function(){var a=io.connect(),b=[],c=function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},d=function(){return Math.random()*document.documentElement.clientWidth},e=function(){return Math.random()*document.documentElement.clientHeight},f=function(){return document.documentElement.clientHeight<document.documentElement.clientWidth?.25*document.documentElement.clientHeight:.25*document.documentElement.clientWidth};a.on("feelingTweet",function(a){b.push(a);var f=d3.select("svg"),h=f.selectAll("g").data(b).enter().append("g").attr({"data-feeling":a.feeling,"data-tweet":a.text}).on("mouseenter",function(){i(this)}).on("mouseleave",function(){console.log("mouse exit"),"selected"!==this.id&&g(this)}).on("click",function(){j(this)});h.attr("transform",function(){var a=d(),b=e();return"translate("+[a,b]+")"}),h.append("circle").attr({r:0,fill:c(),stroke:c(),"stroke-width":2,"class":"circle"}).transition().duration(200).attr("r",20)});var g=function(a){a=a?d3.select(a):d3.selectAll("g"),a.attr("id",""),a.selectAll("text").remove(),a.select("circle").attr("class","circle").transition().duration(200).attr("r",20)},h=function(){d3.select("#tweet-detail").transition().duration(200).style("opacity","0")},i=function(a){a.parentNode.appendChild(a),"selected"!==a.id&&(d3.select(a).select("circle").transition().duration(200).attr("r",50),d3.select(a).append("text").text(a.dataset.feeling).attr({"alignment-baseline":"middle","text-anchor":"middle","class":"label"}))},j=function(a){"selected"===a.id?(console.log("selected group"),g(a),h()):(g(document.getElementById("selected")),a.parentNode.appendChild(a),d3.select(a).attr("id","selected"),d3.select(a).select("circle").transition().duration(200).attr("r",f),document.getElementById("tweet-detail").innerHTML=a.dataset.tweet,d3.select("#tweet-detail").transition().duration(200).style("opacity","0.8"),d3.select(a).append("text").text(a.dataset.feeling).attr({"alignment-baseline":"middle","text-anchor":"middle","class":"label"}))}}}();