/*! We Still Feel Fine Client JS v0.0.1 | Copyright 2013 Lauren Sperber https://github.com/lauren/we-still-feel-fine/blob/master/LICENSE | we-still-feel-fine 2013-08-12 */
!function(){window.onload=function(){var a=io.connect(),b=[],c=function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},d=function(){return Math.random()*document.documentElement.clientWidth},e=function(){return Math.random()*document.documentElement.clientHeight},f=function(){return document.documentElement.clientHeight<document.documentElement.clientWidth?.25*document.documentElement.clientHeight:.25*document.documentElement.clientWidth};a.on("feelingTweet",function(a){console.log(a),b.push(a);var f=d3.select("svg"),g=f.selectAll("g").data(b).enter().append("g");g.attr("transform",function(){var a=d(),b=e();return"translate("+[a,b]+")"}),g.append("circle").attr({cx:0,cy:0,r:0,fill:c(),stroke:c(),"stroke-width":2,"data-feeling":a.feeling,"data-tweet":a.text,"class":"circle"}).transition().duration(200).attr("r",20)});var g=function(a,b,c){a.addEventListener?a.addEventListener(b,c):a.attachEvent(b,c)},h=function(a){d3.select(a).transition().duration(200).attr("class","circle").attr("r",20)},i=function(){d3.select("svg").selectAll("circle").transition().duration(200).attr("r",20).attr("class","circle")},j=function(){d3.select("svg").selectAll("text").remove()},k=function(a){d3.select(a.parentNode).selectAll("text").remove()},l=function(a){d3.select(a).transition().duration(200).style("opacity","0")};g(document,"click",function(a){var b=a.srcElement,c=document.getElementById("tweet-detail");document.createElement("text"),"circle selected"===b.className.baseVal?(h(b),k(b),l(c)):"circle"===b.className.baseVal?(i(),j(),b.parentNode.parentNode.appendChild(b.parentNode),d3.select(b).transition().duration(200).attr("class","circle selected").attr("r",f),c.innerHTML=b.dataset.tweet,d3.select(c).transition().duration(200).style("opacity","0.8"),d3.select(b.parentNode).append("text").text(b.dataset.feeling).attr({"alignment-baseline":"middle","text-anchor":"middle","class":"label"})):(i(),j(),l(c))})}}();